rule POTENTIAL_RU_APT_LNK_DEC23 {
    meta:
        author = "Ryan <@IntelCorgi>"
        date = "2024-03-20"
        description = "Decoy LNK drops HTTP shell and fake PDF. Attributed to unknown RU-nexus threat actor."
        source = "https://blog.cluster25.duskrise.com/2024/01/30/russian-apt-opposition"
    strings:
        $s0 = "CiRFcnJvckFjdGlvbl" ascii
        $s1 = "gci $env:tmp -Name Rar*" ascii wide
    condition:
        uint16(0) == 0x004c and
        filesize < 2MB and
        any of them
}

rule POTENIAL_RU_APT_HTTP_SHELL_DEC23 {
    meta:
        author = "Ryan <@IntelCorgi>"
        date = "2024-03-20"
        description = "HTTP shell used in RU-nexus threat actor campaign."
        source = "https://blog.cluster25.duskrise.com/2024/01/30/russian-apt-opposition"
    strings:
        $s0 = "server/api/v1/Client/" ascii
        $s1 = "HTTPShellNull" ascii
        $s2 = "Mozilla/6.4 (Windows NT 11.1) Gecko/2010102 Firefox/99.0" ascii
        $s3 = "6>&1 5>&1 4>&1 3>&1" ascii
    condition:
        filesize < 2MB and
        all of them
}
